(function (n) {
    (function t(i) {
        n.ListingSearchFilterSelectionController && n.ListingSearchTagController && n.YourLocationServices && n.SearchingSuggestionServices && window.CommonJS && window.CommonJS.Common ? i.HomeSearchBox = function (t) {
            function hr(n, t) { const r = document.querySelector(".ui-autocomplete"); if (typeof t.item != "undefined") { if (t.item !== undefined & typeof t.item.label != "undefined" && t.item.label.length) return !1; let i; return r.querySelectorAll("li.js__search-selection").forEach(n => { n.classList.remove("ui-state-focus"), n.textContent === t.item.FullName && (i = n) }), i ? i.classList.add("ui-state-focus") : null, !1 } } function cr() { var n = u.value; n != t.PRODUCT_TYPES.PROJECT ? document.querySelectorAll(".js__search-box-container-v2").forEach(n => n.classList.remove(window.styleServices.getStyleClass("project"))) : n == t.PRODUCT_TYPES.PROJECT && document.querySelectorAll(".js__search-box-container-v2").forEach(n => n.classList.add(window.styleServices.getStyleClass("project"))) } function lr() { var r = u.value, n = 0, i = ""; r == t.PRODUCT_TYPES.PROJECT ? (o.UpdateList(document.querySelector(".js__project-price-select-list") ? document.querySelector(".js__project-price-select-list").innerHTML : ""), o.UpdateSliderBarConfig(t.PRICE_SLIDER_TYPE.PROJECT), n = document.querySelector(".js__listing-search-select-slider") ? document.querySelector(".js__listing-search-select-slider").getAttribute("data-max") : "", i = `â‰¥ ${n} triá»‡u/mÂ²`) : (r == t.PRODUCT_TYPES.SELL ? (o.UpdateList(document.querySelector(".js__sell-price-select-list") ? document.querySelector(".js__sell-price-select-list").innerHTML : ""), o.UpdateSliderBarConfig(t.PRICE_SLIDER_TYPE.SELL), n = document.querySelector(".js__listing-search-select-slider") ? document.querySelector(".js__listing-search-select-slider").getAttribute("data-max") : "", n > 1e3 && (i = `${n / 1e3} tá»·`)) : r == t.PRODUCT_TYPES.RENT && (o.UpdateList(document.querySelector(".js__rent-price-select-list") ? document.querySelector(".js__rent-price-select-list").innerHTML : ""), o.UpdateSliderBarConfig(t.PRICE_SLIDER_TYPE.RENT), n = document.querySelector(".js__listing-search-select-slider") ? document.querySelector(".js__listing-search-select-slider").getAttribute("data-max") : "", i = `â‰¥ ${n} triá»‡u`), o.SetDefaultText("Khoáº£ng giĂ¡"), o.SetValue(null)); document.querySelectorAll(".js__listing-search-select-slider .js__slider-max-label span").forEach(n => n.innerHTML = i) } function ar() { var n = u.value; n != t.PRODUCT_TYPES.PROJECT ? (c.Show(), c.SetDefaultText("Diá»‡n tĂ­ch"), c.SetValue(null)) : n == t.PRODUCT_TYPES.PROJECT && (c.Hide(), c.SetValue(null)) } function vr() { var n = u.value; n == t.PRODUCT_TYPES.PROJECT ? (gt.classList.add(`${r.DROPDOWN_SHOW}`), v.Show(), v.SetDefaultText("Tráº¡ng thĂ¡i"), v.SetValue(null)) : (gt.classList.remove(`${r.DROPDOWN_SHOW}`), v.Hide(), v.SetValue(null)) } function yr() { var n = u.value; n != t.PRODUCT_TYPES.PROJECT ? (n == t.PRODUCT_TYPES.SELL ? (w.forEach(n => { n.classList.add("re__category-select-sell"), n.classList.remove("re__category-select-rent"), n.classList.remove("re__category-select-project") }), e.UpdateList(document.querySelector(".js__sell-category-select-list") ? document.querySelector(".js__sell-category-select-list").innerHTML : "")) : n == t.PRODUCT_TYPES.RENT && (w.forEach(n => { n.classList.add("re__category-select-rent"), n.classList.remove("re__category-select-sell"), n.classList.remove("re__category-select-project") }), e.UpdateList(document.querySelector(".js__rent-category-select-list") ? document.querySelector(".js__rent-category-select-list").innerHTML : "")), w.forEach(n => { n.querySelectorAll(".select-text").forEach(n => { n.querySelector("i") && (n.querySelector("i").classList.remove(window.styleServices.getStyleClass("icon-building")), n.querySelector("i").classList.add(window.styleServices.getStyleClass("icon-all"))) }) }), e.ChangeToMultiple(), e.SetDefaultText("Loáº¡i nhĂ  Ä‘áº¥t"), e.SetValue(null), e.RemoveChangeEvent(ii)) : n == t.PRODUCT_TYPES.PROJECT && (w.forEach(n => { n.classList.add("re__category-select-project"), n.classList.remove("re__category-select-sell"), n.classList.remove("re__category-select-rent") }), w.forEach(n => { n.querySelectorAll(".select-text").forEach(n => { n.querySelector("i") && (n.querySelector("i").classList.remove(window.styleServices.getStyleClass("icon-all")), n.querySelector("i").classList.add(window.styleServices.getStyleClass("icon-building"))) }) }), e.UpdateList(document.querySelector(".js__project-category-select-list") ? document.querySelector(".js__project-category-select-list").innerHTML : ""), e.ChangeToSingle(), e.SetDefaultText("Loáº¡i hĂ¬nh dá»± Ă¡n"), e.SetValue(null), e.AddChangeEvent(ii)) } function ii() { e.CloseHomePopup() } function ri() { document.querySelector("body").classList.add("loading-body") } function pr() { var n = e.GetValue(); n.indexOf(";") >= 0 ? wr() : br() } function wr() { var n = e.GetSearchButton(), i = o.GetSearchButton(), r = c.GetSearchButton(); n && (n.setAttribute("tracking-id", t.TRACKING_CONSTANTS.TRACKING_ID), n.setAttribute("tracking-label", `loc=${t.TRACKING_CONSTANTS.TRACKING_LABEL_LOC}`)); i && (i.setAttribute("tracking-id", t.TRACKING_CONSTANTS.TRACKING_ID), i.setAttribute("tracking-label", `loc=${t.TRACKING_CONSTANTS.TRACKING_LABEL_LOC}`)); r && (r.setAttribute("tracking-id", t.TRACKING_CONSTANTS.TRACKING_ID), r.setAttribute("tracking-label", `loc=${t.TRACKING_CONSTANTS.TRACKING_LABEL_LOC}`)); nt.forEach(n => { n.setAttribute("tracking-id", t.TRACKING_CONSTANTS.TRACKING_ID), n.setAttribute("tracking-label", `loc=${t.TRACKING_CONSTANTS.TRACKING_LABEL_LOC}`) }) } function br() { var n = e.GetSearchButton(), t = o.GetSearchButton(), i = c.GetSearchButton(); n && (n.removeAttribute("tracking-id"), n.removeAttribute("tracking-label")); t && (t.removeAttribute("tracking-id"), t.removeAttribute("tracking-label")); i && (i.removeAttribute("tracking-id"), i.removeAttribute("tracking-label")); nt.forEach(n => { n.removeAttribute("tracking-id"), n.removeAttribute("tracking-label") }) } function ui(n) { const i = t.PRODUCT_TYPES, r = t.urlProjectSubmit || ""; if (dr(), ri(), !ni) { if (ni = !0, u.value == i.PROJECT) { n.preventDefault(); const i = o.GetValue(); let u = -1, c = -1, l = -1; if (i) if (i.startsWith("[")) { const n = JSON.parse(i); n && n.length === 2 && (c = n[0], l = n[1]) } else u = +i; const a = e.GetValue(), y = a ? a.split(";").map(n => +n) : []; let t = new FormData; t.append("CateId", y.length ? y[0] : 0); t.append("CityCode", h.getAttribute("value") || "CN"); const p = f.querySelector(`.js__LocationType`), w = f.querySelector(`.js__Value`); if (p && w) { const n = w.value; if (p.value == s.Project) { const i = n.split("_")[0], r = parseInt(i); t.append("LegacyId", r) } else t.append("DistrictId", n) } return t.append("PriceLevel", u), t.append("PriceMin", c), t.append("PriceMax", l), t.append("StagesAsString", v.GetValue()), t.append("IsGetFullUrl", !0), fetch(`${nr}${r}`, { method: "POST", body: t }).then(n => n.text()).then(n => { window.location.href = n }), !0 } let t = [nf(n), gu()]; Promise.all(t); document.querySelector("form#boxSearchForm").submit() } } function fi(n) { const t = i.querySelector(n); if (t && t.getAttribute("value").startsWith("[") && t.getAttribute("value").split(",").length === 2) { const n = JSON.parse(t.getAttribute("value")); n[0] === n[1] && t.setAttribute("value", `[0,${n[1]}]`) } } function dr() { fi("#PriceAsString"); fi("#AreaAsString") } function ht(n = 2) { const t = document.querySelectorAll(".js__searching-selected"); t && t[t.length - 1] && t[t.length - 1].classList.add("addBottomGap"); let i = 0, r = f.querySelectorAll(`li`), e = 0; r.forEach(t => { e < n ? t.classList.remove("hidden") : (t.classList.add("hidden"), i += 1), e++ }); let o = vt(u.value); if (r.length >= o ? a.setAttribute("aria-label", `TĂ¬m tá»‘i Ä‘a ${o} khu vá»±c, dá»± Ă¡n`) : a.removeAttribute("aria-label"), i > 0) { f.setAttribute("exceed-limited", !0); const t = `+${i} khu vá»±c`, n = f.querySelector("#summary-choice"); n && n.remove(); f.insertAdjacentHTML("beforeend", `<span id="summary-choice" class="location-tag__choice"><a><span id="summary-tag">${t}</span></a></span>`) } else { f.setAttribute("exceed-limited", !1); const n = f.querySelector("#summary-choice"); n && n.remove() } } function ei(n, t) {
                var i = t.item, k, o, w, c; if (st = l.value, i != undefined) {
                    var e = "", r = i.Type, v = i.Name, y = 0; let n = i.CityCode; r == s.District && (e = i.DistrictId, v = i.DistrictName ? i.DistrictName : i.Name); r == s.Street && (y = i.DistrictId, e = "".concat(i.StreetId, "_", i.DistrictId), v = i.DistrictName && i.StreetName ? "".concat(i.StreetName, ", ", i.DistrictName) : i.Name); r == s.Ward && (y = i.DistrictId, e = "".concat(i.WardId, "_", i.DistrictId), v = i.DistrictName && i.WardName ? "".concat(i.WardName, ", ", i.DistrictName) : i.Name); r == s.Project && (y = i.DistrictId, e = "".concat(i.ProjectId, "_", i.DistrictId)); u.value == ot && (r == s.Street || r == s.Ward) && (e = i.DistrictId, v = i.DistrictName ? i.DistrictName : i.Name, r = s.District); k = f.querySelector(`li[data-search-value="${e}"]`); o = f.querySelectorAll(`li`).length; let l = vt(u.value); if (k == undefined && o < l) if (h.value != n && (f.replaceChildren(), f.setAttribute("exceed-limited", !1), a.removeAttribute("aria-label"), h.value = n, p.querySelector(".js__listing-search-select-button-current-text").textContent = i.CityName), w = f.querySelectorAll(`li[data-search-value*="_${e}"]`), r == s.District && w.length > 0 && (w.forEach(n => { n.remove() }), hi()), c = f.querySelector(`li[data-search-value="${y}"]`), c == undefined) {
                        const n = f.getAttribute("exceed-limited"); o = f.querySelectorAll(`li`).length; $(`<li class="location-tag__choice ${n === "true" ? "hidden" : ""}" data-search-value=${e} data-location-type=${r}>
                                         <a>
                                             <span>${v}</span>
                                         </a>
                                         <input id="Locations_${o}__LocationType" name="Locations[${o}].LocationType" class="js__LocationType" type="hidden" value="${r}">
                                         <input id="Locations_${o}__Value" name="Locations[${o}].Value" type="hidden" class="js__Value" value="${e}">
                                     </li>`).data("ui-autocomplete-item", t.item).appendTo($(f)); ht()
                    } else c.setAttribute("data-location-type", r), c.querySelector(".js__LocationType").value = r, c.setAttribute("data-search-value", e), c.querySelector(".js__Value").value = e, c.querySelector("a>span").innerHTML = `${v}`; if (i.Position) { let n = i.TrackingType === b.HINT ? st : ""; di(i.TrackingType, i.Position, n) }
                }
            } function gr(n, t) { let i = n.target; if (i != null && document.querySelector(".js__listing-search-location-select-dropdown-position .ui-state-active") || n.currentTarget.className && n.currentTarget.className.indexOf("ui-autocomplete") >= 0) ei(n, t); else return n.preventDefault(), !1 } function ct() { const n = document.querySelector(`.${r.FIX}`); if (n && n.classList.add("addPaddingRight"), dt) { const n = document.createElement("div"); n.classList.add(r.OVERLAY); document.querySelector(`.${r.OVERLAY}`) || dt.appendChild(n); g ? document.body.classList.add(r.NO_SCROLL_MAC) : document.body.classList.add(r.NO_SCROLL) } g || isTabletBelow || si(1) } function oi() { const n = document.querySelector(`.${r.FIX}`), t = document.querySelector(`.${r.OVERLAY}`), i = ti && ti.classList.contains(r.DROPDOWN_SHOW_FADE_IN); i || (n && n.classList.remove("addPaddingRight"), g ? document.body.classList.remove(r.NO_SCROLL_MAC) : document.body.classList.remove(r.NO_SCROLL), t && t.remove()); g || isTabletBelow || si() } function si(n = 0) { const s = g ? 15 : 17, i = document.body.querySelector(`#${r.RIGHT_BANNER}`), u = document.body.querySelector(`#${r.LEFT_BANNER}`), f = document.body.querySelector(`.${r.CHAT_CONTAINER}`), e = document.body.querySelector(`${r.FEED_BACK}`), t = document.body.querySelector(`#${r.FORM}`), o = document.body.querySelector(`#${r.GO_TO_TOP}`); let h = document.body.getAttribute("isAdjustedContentFlow"); const c = i && window.getComputedStyle(i, null).getPropertyValue("left"), l = u && window.getComputedStyle(u, null).getPropertyValue("left"), a = f && window.getComputedStyle(f, null).getPropertyValue("right"), v = e && window.getComputedStyle(e, null).getPropertyValue("right"), y = t && window.getComputedStyle(t, null).getPropertyValue("width"), p = o && window.getComputedStyle(o, null).getPropertyValue("right"); if (n) if (h === "false") i && i.style.setProperty("left", `${Number(c.replace("px", "")) - 8.5}px`, "important"), u && u.style.setProperty("left", `${Number(l.replace("px", "")) - 8.5}px`, "important"), f && f.style.setProperty("right", `${Number(a.replace("px", "")) + s}px`, "important"), e && e.style.setProperty("right", `${Number(v.replace("px", "")) + s}px`, "important"), o && o.style.setProperty("right", `${Number(p.replace("px", "")) + s}px`, "important"), isTabletBelow && t && (t.style.setProperty("width", `${Number(y.replace("px", "")) - s}px`, "important"), t.style.setProperty("transition", "", "")), document.body.setAttribute("isAdjustedContentFlow", !0); else return; else i && i.style.setProperty("left", null, ""), u && u.style.setProperty("left", null, ""), f && f.style.setProperty("right", null, ""), e && e.style.setProperty("right", null, ""), o && o.style.setProperty("right", null, ""), isTabletBelow && t && (t && t.style.setProperty("width", null, ""), t.style.setProperty("transition", null, "")), document.body.setAttribute("isAdjustedContentFlow", !1) } function nu() { k(!0); u.value != t.PRODUCT_TYPES.PROJECT && (at(), i.classList.contains(r.SHOW_LOCATION_SELECT_DROPDOWMN) || i.classList.contains(r.SHOW_CITY_SELECT_DROPDOWMN) || rt.SendTrackingDataLayer("open-search-suggestion")); const n = i.querySelectorAll(".re__searching-selected"); for (let t = 0; t < n.length; t++)t < n.length - 1 ? n[t].classList.remove("addBottomGap") : n[t].classList.add("addBottomGap"); return i.classList.contains("fix") && i.classList.add("adjustTopPosition"), i.querySelector(".re__icon-chevron-down--sm").classList.add("re__rotate"), i.classList.remove(r.SHOW_CITY_SELECT_DROPDOWN), i.classList.add(r.SHOW_LOCATION_SELECT_DROPDOWN), d(kt, r.SHOW_FADE_IN), i.querySelector(".re__icon-chevron-down--sm") && i.querySelector(".re__icon-chevron-down--sm").classList.remove("re__rotate"), ct(), !1 } function tu() { return i.getAttribute("fetching") === "true" ? !1 : (a.removeAttribute("aria-label"), l.value = "", $(f).find("li").length > 0 && a.classList.remove("re__location-input"), i.classList.remove(r.SHOW_LOCATION_SELECT_DROPDOWN), i.classList.remove("adjustTopPosition"), i.classList.remove("adjustTopPositionNoCity"), oi(), !1) } function iu(n, r) { var o = [], c = 0, v = 10; let p = f.querySelectorAll(`li`); p && p.length > 0 && p.forEach(n => { if (n) { let t = n.querySelector("a>span"), i = t ? t.innerHTML : "", r = n.getAttribute("data-search-value"), u = n.getAttribute("data-location-type"); o.push({ type: y.SEARCHING_SELECTED, label: i, id: r, value: i, data: { LocationLevel: u } }); c++ } }); let w = vt(u.value); if (c >= w ? a.setAttribute("aria-label", `TĂ¬m tá»‘i Ä‘a ${w} khu vá»±c, dá»± Ă¡n`) : a.removeAttribute("aria-label"), !n.term || n.term.length == undefined || c >= w) { let n = e.GetValue(), i = n; n.indexOf(",") >= 0 && (i = n.slice(0, n.indexOf(","))); et.getPopularSuggestions({ apiPopularSuggestion: t.API_POPULAR_SEARCH, productType: +u.value, cateId: i, cityCode: h.value, size: v }).then(function (n) { for (var t, u = [], i = 0; i < n.length; i++)t = n[i], t.Position = i + 1, t.TrackingType = b.POPULAR, u.push({ type: y.SEARCHING_POPULAR, label: t.FullName, id: i, value: t.Value, data: t }); u.length <= 0 && u.push({ type: y.SEARCHING_POPULAR, label: "ChÆ°a cĂ³ káº¿t quáº£ tĂ¬m kiáº¿m phá»• biáº¿n phĂ¹ há»£p", id: 0, value: "" }); o = o.concat(u); r(o); const f = document.querySelectorAll(".js__search-selection"); l.value.length && f && f[0].classList.add("ui-state-focus") }) } else i.setAttribute("fetching", !0), et.getLocationSuggestions({ keyword: n.term, productType: +u.value, cityCode: h.value, size: v }).then(function (n) { var u = [], t = 0; n.forEach(n => { t < v && !(n.LocationLevel == s.City && n.CityCode == h.value) && (n.Position = t + 1, n.TrackingType = b.HINT, u.push({ type: y.SEARCHING_ITEM, label: n.FullName, id: n.ScopeId, value: n.FullName, data: n }), t++) }); o = o.concat(u); r(o); i.setAttribute("fetching", !1); const f = document.querySelectorAll(".js__search-selection"); l.value.length && f && f[0].classList.add("ui-state-focus") }) } function ru(n, t) { var i = this, r = [], e = [], u = [], f = []; if (t.forEach(function (n) { n.type == y.SEARCHING_SELECTED ? u.push(n) : n.type == y.SEARCHING_POPULAR ? r.push(n) : f.push(n) }), u.length > 0) { let t = $(`<span class="re__delete-all">XĂ³a táº¥t cáº£</span>`).on("click", lt).on("click", tf), r = $(`<div class='re__action'></div>`).append(`<span>Äang chá»n</span>`).append(t); $(`<li class="ui-menu-divider re__ui-menu-divider"></li>`).data("ui-autocomplete-item", { label: "Äang chá»n", value: "Äang chá»n" }).append(r).appendTo(n); u.forEach(function (t) { i._renderItem(n, t) }) } f.length > 0 ? ($(`<li class="js__ui-menu-divider ui-menu-divider"></li>`).data("ui-autocomplete-item", { label: "Gá»£i Ă½ tĂ¬m kiáº¿m", value: "Gá»£i Ă½ tĂ¬m kiáº¿m" }).append(`Gá»£i Ă½ tĂ¬m kiáº¿m`).appendTo(n), f.forEach(function (t) { i._renderItem(n, t) })) : e.length > 0 ? ($(`<li class="js__ui-menu-divider ui-menu-divider"></li>`).data("ui-autocomplete-item", { label: "TĂ¬m kiáº¿m gáº§n Ä‘Ă¢y", value: "TĂ¬m kiáº¿m gáº§n Ä‘Ă¢y" }).append(`TĂ¬m kiáº¿m gáº§n Ä‘Ă¢y`).appendTo(n), e.forEach(function (t) { i._renderItem(n, t) })) : r.length > 0 && ($(`<li class="js__ui-menu-divider ui-menu-divider"></li>`).data("ui-autocomplete-item", { label: "TĂ¬m kiáº¿m phá»• biáº¿n", value: "TĂ¬m kiáº¿m phá»• biáº¿n" }).append(`TĂ¬m kiáº¿m phá»• biáº¿n`).appendTo(n), r.forEach(function (t) { i._renderItem(n, t) })) } function uu(n, t) {
                let r = $(`<i class="re__icon-close-no-circle"></i>`).on("click", ou), i = $(`<a class="selected-tag-link"></a>`); return i.append(`<i class="re__${t && t.data && t.data.LocationLevel == s.Project ? "icon-apartment--sm" : "icon-location--sm"}"></i>
                             <span>${t.label}</span>
                         `).append(r), $(`<li class="js__searching-selected re__searching-selected ui-menu-divider" data-search-value="${t.id}"></li>`).data("ui-autocomplete-item", t).append(i).appendTo(n)
            } function fu(n, t) { if (t) { if (t.data) { let r = t && t.data && t.data.Highlight && t.data.Highlight.length ? t.data.Highlight : "", i = t.data.FullName ? t.data.FullName : t.label; return i = i && i.replace(r, `<span class="re__location-keyword">${r}</span>`), $(`<li class="js__search-selection"></li>`).data("ui-autocomplete-item", t.data).append(`<a><i class="re__${t.data.Type == s.Project ? "icon-apartment--sm" : "icon-location--sm"}"></i><span>${i}</span></a>`).appendTo(n) } let i = t.label; return $(`<li class="suggestion-item-empty ui-menu-divider"></li>`).append(`<span>${i}</span>`).appendTo(n) } } function eu(n, t) { return t.type === y.SEARCHING_SELECTED ? uu(n, t) : fu(n, t, this.term) } function ou(n) { let u = n.target, t = u.closest(".js__searching-selected"), i = t.closest(`ul`); var e = t.getAttribute("data-search-value"); f.querySelector(`li[data-search-value="${e}"]`).remove(); t.remove(); i.querySelectorAll(".js__searching-selected").length <= 0 && i.querySelector(".re__ui-menu-divider").remove(); hi(); ht(); let o = n.target.parentElement.children, s = o[0].classList.contains(r.ICON_LOCATION_SMALL); gi(b.EVENT.REMOVE_SEARCH_TAG, s ? "location" : "project") } function lt(n) { if (f.replaceChildren(), f.setAttribute("exceed-limited", !1), a.removeAttribute("aria-label"), n && (n.srcElement || n.target)) { let t = n && n.srcElement ? n.srcElement : n.target, i = t.closest(`ul`); const r = i.querySelectorAll(".js__searching-selected"); r.forEach(n => { n.remove() }); t.closest(`li`).remove() } } function hi() { var n = 0; for (let t = 0; t < f.children.length; t++)if (f.children[t] && f.children[t].nodeName === "LI") { let i = f.children[t].querySelector(".js__LocationType"); i.setAttribute("id", `Locations_${n}__LocationType`); i.setAttribute("name", `Locations[${n}].LocationType`); i.setAttribute("exceed-limited", !1); let r = f.children[t].querySelector(".js__Value"); r.setAttribute("id", `Locations_${n}__Value`); r.setAttribute("name", `Locations[${n}].Value`); r.setAttribute("exceed-limited", !1); n++ } } function su() { l.value === "" && $(l).autocomplete("search", "") } function hu(n) { if (n.key === "ArrowDown") { const t = document.querySelector(".ui-state-focus"), i = t && t.classList.contains("ui-menu-divider"); if (!i && !t) return n.preventDefault(), n.stopPropagation(), !1 } if (n.key === "Enter") { const n = document.querySelectorAll(".ui-state-focus"), t = n && n[n.length - 1]; t && t.click() } } function cu() { return "ontouchstart" in window || navigator.maxTouchPoints > 0 || navigator.msMaxTouchPoints > 0 } function k(n = false) { n ? ut = 0 : ut++ } function lu() { p.addEventListener("mousedown", () => { k(), ut > 1 ? tt() : ai() }); cu() && p.addEventListener("touchstart", () => { k(), ut > 1 ? tt() : ai() }); let n = i.querySelectorAll(".js__city-search-select-dropdown .js__option"); n.length > 0 && n.forEach(n => { n.addEventListener("click", () => { au(n) }) }) } function au(n) { let t = n.getAttribute("value"), i = n.querySelector("span").textContent; t && i && (h.value = t, p.querySelector(".js__listing-search-select-button-current-text").textContent = i); vu(); li() } function ci(n) { var t = n && n.target ? n.target : undefined; const u = t.classList.contains(r.CLOSE_ICON), e = t.classList.contains(r.DELETE_ALL_BTN), o = t.classList.contains(r.NO_CITY_CLOSE_BTN), s = !i.contains(t), h = !i.classList.contains(r.SHOW_CITY_SELECT_DROPDOWN) || !i.classList.contains(r.SHOW_NO_CITY_SELECT_DROPDOWN); (o && tt(), e || u) || s && h && (tt(), f.children.length && a.classList.remove("re__location-input")) } function d(n, t) { if (n && n.dataset.animating !== "1") { n.dataset.animating = "1"; n.classList.remove(t); void n.offsetWidth; n.classList.add(t); const i = () => { n.dataset.animating = "0", n.removeEventListener("animationend", i), n.removeEventListener("animationcancel", i) }; n.addEventListener("animationend", i); n.addEventListener("animationcancel", i) } } function tt() { k(!0); i.classList.remove(r.SHOW_NO_CITY_SELECT_DROPDOWN); i.classList.remove(r.SHOW_CITY_SELECT_DROPDOWN); i.classList.remove(r.SHOW_LOCATION_SELECT_DROPDOWN); oi(); i.querySelector(".re__icon-chevron-down--sm") && i.querySelector(".re__icon-chevron-down--sm").classList.remove("re__rotate"); i.classList.remove("adjustTopPosition"); i.classList.remove("adjustTopPositionNoCity") } function li(n = true) { lt(); h.value ? (i.classList.add("re__search-has-location-input"), a.classList.add("re__location-input"), n && ($(l).focus(), $(l).autocomplete("search", ""))) : i.classList.remove("re__search-has-location-input") } function ai() { if (k(!0), i.classList.contains("fix") && i.classList.add("adjustTopPosition"), i.querySelector(".re__icon-chevron-down--sm") && i.querySelector(".re__icon-chevron-down--sm").classList.add("re__rotate"), h.value) { i.classList.remove(r.SHOW_LOCATION_SELECT_DROPDOWN); i.classList.add(r.SHOW_CITY_SELECT_DROPDOWN); d(bt, r.SHOW_FADE_IN); ct(); const n = i.querySelectorAll(".js__city-search-select-dropdown .js__option"); n.forEach(n => { n.getAttribute("value") === h.value ? n.classList.add("selected-item") : n.classList.remove("selected-item") }) } else i.classList.remove(r.SHOW_LOCATION_SELECT_DROPDOWN), i.classList.add(r.SHOW_NO_CITY_SELECT_DROPDOWN), i.classList.remove("adjustTopPosition"), i.classList.contains("fix") && i.classList.add("adjustTopPositionNoCity"), d(ur, r.SHOW_FADE_IN), ct(), d(bt, r.SHOW_FADE_IN), i.querySelector(".js__listing-search-no-city-button-close").addEventListener("click", () => { tt() }); document.body.addEventListener("click", ci) } function vu() { k(!0); u.value != t.PRODUCT_TYPES.PROJECT && at(); i.querySelector(`.${r.CITY_ICON_SEARCH}`).classList.remove(r.ICON_SEARCH); i.querySelector(`.${r.CITY_ICON_SEARCH}`).classList.add(r.ICON_LOCATION); i.classList.contains("fix") && i.classList.add("adjustTopPosition"); d(kt, r.SHOW_FADE_IN); i.classList.remove(r.SHOW_CITY_SELECT_DROPDOWN); i.classList.remove(r.SHOW_NO_CITY_SELECT_DROPDOWN); i.classList.add(r.SHOW_LOCATION_SELECT_DROPDOWN); d(fr, r.SHOW_FADE_IN); document.querySelector(".re__bg-header").addEventListener("click", ci) } function vi(n, t) { if (t.level || t.min || t.max) if (t.level) n.SetValue(t.level.toString(10)); else { var i = []; t.min && i.push(t.min); t.max && (t.min || i.push(0), i.push(t.max)); n.SetValue(JSON.stringify(i)) } else n.SetValue(null) } function yu(n) { var t = document.querySelector("#CategoryIdsAsString"); if (t) t.value = n.join(";") } function yi(n) { return /\d/.test(n) } function pi(n) { h.value = n ? n : null } function pu() { } function it() { var n = e.GetValue(), t = e.GetTextOptionsSelected(!0).join(", "), i = n ? n.split(";") : []; return { ids: i, label: t } } function wu() { let n = p.querySelector(".js__listing-search-select-button-current-text"); var t = null, i = null; return n && h && (i = h.value, t = n.textContent), { code: i, label: t } } function wi() { let n = f.querySelectorAll(`li`); var t = []; return n && n.length > 0 && n.forEach(n => { if (n) { var r = n.querySelector("a>span"), i = {}; i.id = n.getAttribute("data-search-value"); i.label = r ? r.innerHTML : ""; i.locationType = n.getAttribute("data-location-type"); t.push(i) } }), t } function bi() { var r = null, u = null, f = null, t = o.GetTextOptionsSelected(!0).join(", "), n = o.GetValue(), i; return t = t.replace("â‰¤", "DÆ°á»›i").replace("<", "DÆ°á»›i").replace("â‰¥", "TrĂªn").replace(">", "TrĂªn").replace("Thá»a thuáº­n", "GiĂ¡ thá»a thuáº­n"), n.startsWith("[") ? (i = JSON.parse(n), r = i[0], u = i[1]) : n && (f = +n), { max: u, min: r, level: f, label: t } } function ki() { var r = null, u = null, f = null, t = c.GetTextOptionsSelected(!0).join(", "), n = c.GetValue(), i; return t = t.replace("â‰¤", "DÆ°á»›i").replace("<", "DÆ°á»›i").replace("â‰¥", "TrĂªn").replace(">", "TrĂªn"), n.startsWith("[") ? (i = JSON.parse(n), r = i[0], u = i[1]) : n && (f = +n), { max: u, min: r, level: f, label: t } } function bu() { var n = {}, t, i, r, f; n.productType = u.value; n.category = it(); n.city = wu(); n.locations = wi(); n.area = ki(); n.price = bi(); n.room = { ids: [], label: "" }; n.direction = { ids: [], label: "" }; n.media = { ids: [], label: "" }; return n.verification = !1, t = "", n.locations.length > 0 && (i = [], n.locations.forEach(n => { var t, u, r; n.label && (t = n.label.trim(), u = t.split(","), u.length > 1 ? (r = [], u.forEach(n => { yi(n) ? r.push(n.trim()) : r.push(n.replace("Quáº­n", "").replace("Huyá»‡n", "").replace("Thá»‹ xĂ£", "").replace("ThĂ nh phá»‘", "").replace("PhÆ°á»ng", "").replace("XĂ£", "").replace("Thá»‹ tráº¥n", "").trim()) }), i.push(r.join(", "))) : (yi(t) || (t = t.replace("Quáº­n", "").replace("Huyá»‡n", "").replace("Thá»‹ xĂ£", "").replace("ThĂ nh phá»‘", "").replace("PhÆ°á»ng", "").replace("XĂ£", "").replace("Thá»‹ tráº¥n", "").trim()), i.push(t))) }), t = i.join(", ")), t ? t = ` táº¡i ${t}, ${n.city.label}` : n.city.code && (t = ` táº¡i ${n.city.label}`), n.category.ids && n.category.ids.length > 0 ? (r = n.productType == 38 ? "BĂ¡n" : "Cho thuĂª", n.title = `${r} ${n.category.label}${t}`) : (f = n.productType == 38 ? "NhĂ  Ä‘áº¥t bĂ¡n" : "NhĂ  Ä‘áº¥t cho thuĂª", n.title = `${f}${t}`), n } function ku() { const n = {}; n.productType = +u.value; n.intent = +u.value == 38 ? "Sell" : "Rent"; it() && it().ids && it().ids.length > 0 && (n.cates = it()); n.cityCode = h.value; const f = {}, i = ki(); if (i.level) { let n = ft.GetAreaLevelValues(i.level, +u.value); n.length === 2 && n[0] != null && n[1] != null && (n[0] === n[1] ? f.minArea = n[0] : (f.minArea = n[0], f.maxArea = n[1])) } else i.min && i.min !== 0 && (f.minArea = i.min), i.max && i.max !== 0 && (f.maxArea = i.max); n.area = f; const r = {}, t = bi(); if (t.level != null && (r.negotiablePrice = t.level === 0), t.level) { let n = ft.GetPriceLevelValues(t.level, +u.value); n.length === 2 && n[0] != null && n[1] != null && (n[0] === n[1] ? r.minPrice = n[0] : (r.minPrice = n[0], r.maxPrice = n[1])) } else t.min && t.min !== 0 && (r.minPrice = t.min), t.max && t.max !== 0 && (r.maxPrice = t.max); n.price = r; const e = wi(); if (e && e.length > 0) { let t = [], i = [], r = [], u = []; e.forEach(n => { let f = n.id.includes("_") ? n.id.split("_") : [n.id], e = +n.locationType; e === s.District ? t.push(+f[0]) : e !== s.District && f.length > 1 && t.push(+f[1]); e === s.Ward && i.push(+f[0]); e === s.Street && r.push(+f[0]); e === s.Project && u.push(+f[0]) }); t.length > 0 && (n.districtIds = t); i.length > 0 && (n.wardIds = i); r.length > 0 && (n.streetIds = r); u.length > 0 && (n.projectIds = u) } return n.freeText = null, n } function du() { const n = ku(); return { eventData: { cateId: n.cates && n.cates.ids, intent: n.intent, cities: n.cityCode, districts: n.districtIds, wards: n.wardIds, street: n.streetIds, projects: n.projectIds, negotiablePrice: n.price.negotiablePrice, minPrice: n.price.minPrice, maxPrice: n.price.maxPrice, minArea: n.area.minArea, maxArea: n.area.maxArea }, metaData: { location: cm.DeterminePageTrackingType(window.location.pathname) } } } function gu() { if (window.SegmentClient && +u.value !== t.PRODUCT_TYPES.PROJECT) return new Promise(function (n) { let t = du(); window.SegmentClient.NewSearch(t).then(() => n()) }) } function at() { } function vt(n) { return n == ot ? rr : ir } function nf(n) { return new Promise(function (t) { let i = bu(rf(n)); rt.PushTrackingDataLayer(i, null, st, null, null); t() }) } function di(n, t, i) { return new Promise(function (r) { let u = []; u.push({ label: "suggestType", data: n }); u.push({ label: "pos", data: t }); i && u.push({ label: "kwHint", data: i }); rt.SendTrackingDataLayer(b.EVENT.CLICK_SEARCH_SUGGESTION, u); r() }) } function gi(n, t) { return new Promise(function (i) { let r = []; t && r.push({ label: "tagType", data: t }); rt.SendTrackingDataLayer(n, r); i() }) } function tf(n) { return new Promise(function (t) { n.target.tagName.toLowerCase() === "span" && gi(b.EVENT.REMOVE_ALL_SEARCH_TAG); t() }) } function rf(n) { return n && n.target && n.target.innerHTML && n.target.innerHTML.includes("TĂ¬m kiáº¿m") } var et, tr, pt, y; let ft; n.AdvancedFilter && (ft = new n.AdvancedFilter.Helpers); const yt = document.querySelector("#staticDomain"), nr = yt != undefined ? yt.getAttribute("data-msvrouter") : ""; et = new n.SearchingSuggestionServices; tr = new n.YourLocationServices; const rt = new n.SearchingTrackingService, g = navigator.userAgent.includes("Mac"), ot = 351, ir = 5, rr = 1; pt = document.querySelector("#Keyword"); const i = document.querySelector("#boxSearchForm"), wt = document.querySelector(".js__search-row-location"), p = wt.querySelector(".js__city-code-select"), h = wt.querySelector("#CityCode"), ur = document.querySelector(".re__header-item-no-city"), bt = document.querySelector(".js__city-search-select-dropdown"), kt = document.querySelector(".js__location-search-select-dropdown"), fr = document.querySelector(".re__city-search-select-list"); i.setAttribute("isnewsearch", !0); document.body.setAttribute("isAdjustedContentFlow", !1); isTabletBelow = window.innerWidth < 850; let ut = 0; const dt = document.querySelector(".re__main"); var l = document.querySelector("#LocationSearch"), a = document.querySelector(".js__location-select"), ff = document.querySelector(".re__icon-search"), f = document.querySelector(".js__location-tags"), gt = i.querySelector(".js__stages-select"), w = document.querySelectorAll(".re__category-select"), u = document.querySelector("#ProductType"), nt = document.querySelectorAll("#btnSearch, .js__location-search-button, .js__lfilter-more-search-button"), er = document.querySelectorAll(".js__click-load-page, .js__box-loading a"), e = new n.ListingSearchFilterSelectionController(document.querySelector("#CategoryIdsAsString"), { defaultScroll: !1, filterType: "Cate" }), o = new n.ListingSearchFilterSelectionController(document.querySelector("#PriceAsString"), { defaultScroll: !1 }), c = new n.ListingSearchFilterSelectionController(document.querySelector("#AreaAsString"), { defaultScroll: !1 }); const v = new n.ListingSearchFilterSelectionController(document.querySelector("#StagesAsString"), { defaultScroll: !1 }), s = { Project: 5, District: 3, Ward: 6, Street: 2, City: 1 }; y = { SEARCHING_POPULAR: "SEARCHING_POPULAR", SEARCHING_HISTORY: "SEARCHING_HISTORY", SEARCHING_ITEM: "SEARCHING_ITEM", SEARCHING_SELECTED: "SEARCHING_SELECTED" }; const r = { SHOW_NO_CITY_SELECT_DROPDOWN: "re__show-no-city-select-dropdown", SHOW_CITY_SELECT_DROPDOWN: "re__show-city-select-dropdown", SHOW_LOCATION_SELECT_DROPDOWN: "re__show-location-select-dropdown", DROPDOWN_SHOW: "re__show", HIDDEN: "hidden", SHOW_FADE_IN: "re__show-fade-in", CITY_ICON_SEARCH: "re__city-icon-search", ICON_SEARCH: "re__icon-search", ICON_LOCATION: "re__icon-location", RIGHT_BANNER: "ban_wide_right", LEFT_BANNER: "ban_wide_left", CHAT_CONTAINER: "re__live-chat-container", FIX: "re__fix", NO_SCROLL: "no-scroll", NO_SCROLL_MAC: "no-scroll-mac", FEED_BACK: 'div[class*="__MinimizedWidgetMiddle__right"]', CONTINUE_SEARCH: "re__location-continue-search", OVERLAY: "re__overlay", DROPDOWN: "js__listing-search-select-select-dropdown", CONTAINER: "js__listing-search-select-container", ICON_LOCATION_SMALL: "re__icon-location--sm", CLOSE_ICON: "re__icon-close-no-circle", DELETE_ALL_BTN: "re__delete-all", NO_CITY_CLOSE_BTN: "no-city-button-close", GO_TO_TOP: "gototop", SHOW_LOCATION_SELECT_DROPDOWMN: "re__show-location-select-dropdown", SHOW_CITY_SELECT_DROPDOWN: "re__show-city-select-dropdown" }, b = { EVENT: { CLICK_SEARCH_SUGGESTION: "click-search-suggestion", REMOVE_SEARCH_TAG: "remove-search-tag", REMOVE_ALL_SEARCH_TAG: "remove-all-search-tag" }, POPULAR: "Popular", RECENT: "Recent", HINT: "Hint" }; var ni = !1, or = document.querySelector(`.${r.CONTAINER}`), ti = or.querySelector(`.${r.DROPDOWN}`), st = ""; const ef = t.ENABLE_MULTIPLE_SEARCHING_HISTORIES ? t.ENABLE_MULTIPLE_SEARCHING_HISTORIES : !1, sr = new window.CommonJS.Common; (function () { document.querySelectorAll(".js__product-type li").forEach(n => n.addEventListener("click", function (n) { u.value = n.target.getAttribute("data-type"); u.dispatchEvent(new Event("change")) })); var n = u.value; n == t.PRODUCT_TYPES.SELL ? w.forEach(n => n.classList.add("re__category-select-sell")) : n == t.PRODUCT_TYPES.RENT && w.forEach(n => n.classList.add("re__category-select-rent")); u.addEventListener("change", function () { var t = u.value; document.querySelectorAll(".js__product-type li").forEach(n => n.classList.remove("re__actived")); document.querySelectorAll(`.js__product-type li[data-type="${t}"]`).forEach(n => n.classList.add("re__actived")); let n = i.querySelector(`.${r.CONTINUE_SEARCH}`); n && +t == ot ? (n.classList.add(r.HIDDEN), li(!1)) : n && n.classList.remove(r.HIDDEN) }); u.addEventListener("change", yr); u.addEventListener("change", lr); u.addEventListener("change", ar); u.addEventListener("change", vr); u.addEventListener("change", cr); lu(), function s() { window.$ && window.$.ui && window.$.ui.autocomplete ? ($(l).autocomplete({ appendTo: ".js__location-autocomplete", open: nu, source: iu, minLength: 0, select: gr, close: tu, focus: hr }), $.ui.autocomplete.prototype._renderMenu = ru, $.ui.autocomplete.prototype._renderItem = eu) : setTimeout(s, 100) }(); ht(); l.addEventListener("click", su); l.addEventListener("keydown", hu); e.AddChangeEvent(pr); e.AddClickApplyEvent(() => { e.CloseHomePopup() }); nt.forEach(n => n.addEventListener("click", ui)); er.forEach(n => { n.addEventListener("click", ri) }); f.addEventListener("click", function () { a.classList.add("re__location-input"); $(l).focus(); $(l).autocomplete("search", "") }); o.AddChangeEvent(function (n, t) { t.changeFromClickOption && o.CloseHomePopup() }); o.AddClickApplyEvent(() => { o.CloseHomePopup() }); c.AddChangeEvent(function (n, t) { t.changeFromClickOption && c.CloseHomePopup() }); c.AddClickApplyEvent(() => { c.CloseHomePopup() }); v.AddChangeEvent(function () { }); v.AddClickApplyEvent(() => { v.CloseHomePopup() }); u.value != t.PRODUCT_TYPES.PROJECT && at(); pu(); window.addEventListener("message", function (n) { if ((!window.Common || window.Common.IsMessageOriginTrusted(n)) && n.data.messageType == "SEARCH_LISTINGS") { u.value = n.data.data.productType; u.dispatchEvent(new Event("change")); n.data.data.categoryId && e.SetValue(n.data.data.categoryId + ""); h.value = n.data.data.cityCode; h.dispatchEvent(new Event("change")); n.data.data.price && o.SetValue(n.data.data.price); n.data.data.area && c.SetValue(n.data.data.area); let r = (n.data.data.locations || []).length ? n.data.data.locations[0] : {}; if (!n.data.data.districtId && !r.id) { nt[0].dispatchEvent(new CustomEvent("click", { detail: { ignoreSaveHistory: !0 } })); return } let t = document.createElement("input"); t.id = "Locations_0__LocationType"; t.name = "Locations[0].LocationType"; t.type = "hidden"; let i = document.createElement("input"); i.id = "Locations_0__Value"; i.name = "Locations[0].Value"; i.type = "hidden"; n.data.data.projectId ? (t.value = 5, i.value = `${n.data.data.projectId}_${n.data.data.districtId}`) : n.data.data.streetId ? (t.value = 2, i.value = `${n.data.data.streetId}_${n.data.data.districtId}`) : n.data.data.wardId ? (t.value = 6, i.value = `${n.data.data.wardId}_${n.data.data.districtId}`) : n.data.data.districtId ? (t.value = 3, i.value = n.data.data.districtId) : r && (t.value = r.locationType, i.value = r.id); f.append(t); f.append(i); nt[0].dispatchEvent(new CustomEvent("click", { detail: { ignoreSaveHistory: !0 } })) } }) })()
        } : setTimeout(function () { t(i) }, 100)
    })(n.Home || (n.Home = {}))
})(window.FrontEnd || (window.FrontEnd = {}));